@model PaginatedList<MaoriSouvenirShopping.Models.Souvenir>
@{
    ViewData["Title"] = "Index";
}

<h2>Index</h2>
<p class="text-danger">@Html.ValidationMessage("cannotAddtoCart")</p>
<div class="container-fluid">
    <div class="col-md-3" style="position:relative;top:0px">
        <ul class="nav navbar-left">
            <li class="nav-header" style="font-size:22px;padding:20px 20px 20px 20px">
                Category
            </li>
            <li><hr /></li>
            <li class="active">
                @Html.ActionLink("Jewels", "Index", new { category = "Jewel" })
            </li>
            <li>
                @Html.ActionLink("Crafts", "Index", new { category = "Craft" })
            </li>
            <li>
                @Html.ActionLink("Arts", "Index", new { category = "Art" })
            </li>
            <li>
                @Html.ActionLink("Foods", "Index", new { category = "Food" })
            </li>
            <li>
                @Html.ActionLink("All Categories", "Index", new { category = "AllCategories" })
            </li>
        </ul>
    </div>
    <div class="col-md-9">
        <form asp-action="Index" method="get">
            <div class="form-actions no-color">
                <p>
                    Find by name: <input type="text" name="SearchString" value="@ViewData["currentFilter"]" />
                    <input type="submit" value="Search" class="btn btn-default" /> |
                    <a asp-action="Index">Back to Full List</a>
                </p>
                <p>
                    Price range: <input type="text" name="lower_price" value="@ViewData["lowerPrice"]" onkeyup="value=value.replace(/[^\d.]/g,'')" />
                    - <input type="text" name="upper_price" value="@ViewData["upperPrice"]" onkeyup="value=value.replace(/[^\d.]/g,'')" />
                    <input type="submit" value="Filter this Price Range" class="btn btn-default" />
                </p>
            </div>
        </form>
        <table class="table">
            <thead>
                <tr>
                    <th>
                        Image
                    </th>
                    <th>
                        <a asp-action="Index" asp-route-sortOrder="@ViewData["NameSortParm"]" asp-route-currentFilter="@ViewData["CurrentFilter"]">Name</a>
                    </th>
                    <th>
                        <a asp-action="Index" asp-route-sortOrder="@ViewData["PriceSortParm"]" asp-route-currentFilter="@ViewData["CurrentFilter"]">Price</a>
                    </th>
                    <th>
                        Description
                    </th>
                    <th>
                        Category
                    </th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model)
                {
                    var imgUrl = @Href("~" + item.PhotoPath);
                    var errImg = @Href("~/images/Error.svg");
                <tr>
                    <td>
                        <img style="width: 250px; height: auto;" src="@imgUrl" alt="Souvenir Image" onerror="this.onerror = null; this.src = '@errImg'">
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.SouvenirName)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Price)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Description)
                    </td>
                    <td>
                        @Html.DisplayFor(modelItem => item.Category.CategoryName)
                    </td>
                    <td>
                        <a asp-action="Details" asp-route-id="@item.SouvenirID">Details</a>|
                        <a asp-action="AddToCart" asp-controller="ShoppingCart" asp-route-id="@item.SouvenirID" asp-route-rv=@item.RV>
                            <span class="glyphicon glyphicon-shopping-cart"></span>
                            Add To Cart
                        </a>
                    </td>
                </tr>
                }
            </tbody>
        </table>
        @{
            var prevDisabled = !Model.HasPreviousPage ? "disabled" : "";
            var nextDisabled = !Model.HasNextPage ? "disabled" : "";
        }
    </div>
</div>
